# 시스템 보안

## 🔑 보안이란?

보안은 CIA라고 불리는 3대 요소가 있다.

- Confidentiality(기밀성)
  - 유출되지 않아야 한다
  - 데이터 기밀성, 프라이버시를 일컫음
  - 특정 데이터가 허가받지 않은, 인증되지 않은 사용자에게 노출되지 않게 하는 것
  - 기밀성을 해치는 공격은 도청, 사회 공학 등이 있음
  - 기밀성을 보존하려면 Identification(식별), 인증, 권한부여, 암호화해야 함
- Integrity(무결성)
  - 정보가 변질되지 않아야 한다
  - 데이터가 악의적인 사용자에 의해 변하거나, 없어지면 안된다
  - 무결성을 해치는 공격은 위조와 Repudiation(부인)이 있음
  - 무결성을 보존하려면 접근 제어, 메시지, 데이터 인증이 있음
- Availability(가용성)
  - 인증받은 사용자는 시스템이나 데이터를 사용할 수 있어야 함
  - 가용성을 해치는 공격은 DOS(Denial of Service; 서비스 거부), DDOS(Distributed Denial of Service; 분산 서비스 거부 공격)이 있음





## 시스템 보안이란?

시스템은 하드웨어 뿐만 아니라 소프트웨어까지 매우 많은 것을 포괄하는 개념이다. 때문에 시스템과 관련된 보안 주제는 훨씬 큰 범위의 보안, 조직이나 국가 단위의 보안 요소를 다루는 일과 흡사하다.

좁은 의미에서 시스템 보안은 권한이 없거나 허가받지 않은 사용자가 파일이나 폴더, 장치 등을 사용하지 못하게 제한하여 시스템을 보호하는 기능으로 다음과 같은 관리가 필요하다.

- `계정 관리`: 사용자 계정의 생성, 수정, 삭제 및 권한 설정을 통해 시스템 접근 통제
- `세션 관리`: 사용자의 세션을 관리하고, 비정상적인 세션 활동을 감지하여 시스템 보호
- `접근 제어`: 특정 사용자나 프로세스가 시스템 자원에 접근할 수 있는 권한을 설정하고 관리
- `권한 관리`: 시스템 내에서 사용자와 애플리케이션이 수행할 수 있는 작업의 범위를 제한
- `로그 관리`: 시스템 내에서 발생하는 모든 활동을 기록하고, 이를 분석하여 보안 위험을 감지
- `취약점 관리`: 시스템 내의 보안 취약점을 식별하고, 이를 신속하게 수정하여 보안을 강화



## ✔️ 계정 관리

### 운영체제의 계정 관리

운영체제 관리자로부터 응용 프로그램에 있는 기밀 정보, 인증 정보 등을 보호하는 한 가지 방법은 응용 프로그램을 암호화하는 것이다.

운영체제 내에서는 관리자 권한을 가진 계정뿐만 아니라 일반 사용자 권한을 가진 계정도 적절하게 제한해야 한다.

- 윈도우의 계정관리
  - `administrator`: 운영체제의 관리자 권한을 가진 계정으로, 철저한 보호가 필요
  - `net localgroup administrators` : 관리자 그룹에 속하는 각 계정의 존재 형태를 확인 가능 → 필요하지 않은 계정은 삭제하거나 권한 제한
  - `net localgroup`: 시스템에 존재하는 그룹 목록을 확인 가능
- 유닉스의 계정 관리
  - `root`: 유닉스 계열의 시스템에서는 기본 관리자 계정이 존재함
    - 유닉스의 최고 권한 계정으로, 모든 시스템 자원에 접근할 수 있음. 때문에 매우 중요한 보안 대상임.

  - `/etc/passwd 파일` : 계정 목록 확인 가능
  - `/etc/group 파일`: 그룹 확인 가능
  - 유닉스에서도 `root`를 제외한 그룹은 윈도우처럼 모두 임의로 생성되며, 고유의 권한도 없음




### 데이터베이스의 계정 관리

운영체제 계정을 제대로 관리하지 못하면 데이터베이스 계정 관리는 아무 소용이 없다. 데이터베이스 관리자 계정은 중요한 데이터를 처리하므로, 불필요한 접근을 최소화하고 정기적으로 계정 상태를 점검해야 한다.

데이버테이스 계정 관리도 운영체제와 마찬가지로 관리자 계정과 일반 사용자 계정으로 나뉜다.

- MS-SQL의 관리자 계정
  - `sa`: System Administrator으로, 모든 데이터베이스에 대한 접근 권한을 가짐
- 오라클의 관리자 계정
  - `sys`, `system`
    - `sys`는 최상위 관리자 계정으로, 데이터베이스 운영에 필수적인 권한을 가짐
    - `sys`와 달리 `system` 계정은 데이터베이스를 생성할 수 없는 계정



## ✔️ 세션 관리

> 📎 **세션(Session)이란?**
>
> 세션이란 클라이언트로부터 오는 일련의 요청을 하나의 상태로 보고 그. 상태를 일정하게 유지하는 기술이다. 
>
> 세션은 웹 서버에 웹 컨테이너의 상태를 유지하기 위한 정보를 저장하는데, 브라우저를 닫거나 서버에서 세션을 삭제하면 세션이 삭제된다.
>
> 세션은 각 클라이언트의 고유세션 ID를 부여하는데, 이것으로 클라이언트를 구분하여 각 클라이언트의 요구에 맞는 응답을 반환한다.
>
> 즉, <u>세션은 사용자가 시스템에 접속한 시점부터 로그아웃할 때까지의 일련의 활동을 의미</u>한다.
>
> 
>
> **⚙️ 세션의 동작 순서**
>
> 1. 클라이언트 요청
> 2. Request-Header 필드의 Cookie에서 세션ID를 보냈는지 확인
>    - 세션ID가 없을 경우, 서버에서 생성하여 클라이언트에게 전송
> 3. 쿠키를 사용해 세션 ID를 서버에 저장
> 4. 클라이언트 접속 시, 쿠키를 이용하여 세션ID 값을 서버에 전달
>
> 
>
> 🍪 **쿠키와 세션의 차이**
>
> | 구분                   | 쿠키(Cookie)      | 세션(Session)         |
> | ---------------------- | ----------------- | --------------------- |
> | 저장 위치              | 클라이언트        | 서버                  |
> | 라이프사이클(만료시점) | 쿠키 저장 시 설정 | 브라우저 종료 시 삭제 |
> | 보안                   | 비교적 취약       | 안전                  |
> | 속도                   | 빠름              | 비교적 느림           |
>
> 

세션 관리는 세션 하이재킹(Session Hijacking)이나 네트워크 패킷 스니핑(Packet Sniffing)에 대응하기 위해 암호화를 해야한다. 또한 세션에 대한 지속적인 인증도 필요하다.

> 🎭 **세션 하이재킹(Session Hijacking)**
>
> 세션 하이재킹이란 공격자가 사용자의 세션ID를 탈취하여 해당 사용자의 권한을 도용하는 공격이다. 이를 방지하기 위해 다음과 같은 보안 조치가 취해져야 한다.
>
> - **세션 ID 암호화**: 세션 ID를 암호화하여 탈취된 세션 ID가 사용되지 않도록 함
> - **세션 ID 갱신**: 중요한 작업이 끝날 때마다 세션 ID를 갱신하여, 이전 세션 ID가 더 이상 유효하지 않도록 함

> 🛜 **네트워크 패킷 스니핑(Packet Sniffing)**
>
> 패킷 스니핑은 네트워크를 통해 전송되는 데이터를 가로채어 분석하는 공격이다. 이를 방지하기 위해 전송 중인 데이터를 암호화해야 한다. HTTPS 프로토콜을 사용하여 세션 정보가 포함된 모든 트래픽을 암호화함으로써, 패킷 스니핑 공격으로부터 데이터를 보호할 수 있다.

- 시스템에서는 이러한 문제를 세션에 대한 타임아웃 설정으로 보완 (ex. 윈도우의 화면 보호기)
- 데이터베이스에서는 일반적으로 세션에 대한 타임아웃을 적용하지 않음
  - 데이터베이스는 사람이 접근하는 경우도 있지만, 대부분 시스템 간의 세션을 가지고 있기 때문



## ✔️ 접근 제어

접근 제어는 시스템 보안에서 핵심적인 역할을 한다. 접근 제어는 어떤 자원이 누구에 의해 사용될 수 있는지를 결정하며, 적절한 접근 제어가 이루어지지 않으면 시스템 전체가 위험에 노출될 수 있다.



### 접근 제어 모델

- **역할 기반 접근 제어(RBAC)**: 사용자의 역할에 따라 접근 권한을 부여하는 방식으로, 효율적인 권한 관리를 가능하게 함
- **임의 접근 제어(DAC)**: 데이터 소유자가 접근 권한을 설정하는 방식으로, 개인화된 권한 관리를 제공함
- **강제 접근 제어(MAC)**: 시스템이 중앙에서 접근 정책을 강제하는 방식으로, 매우 높은 보안 요구 사항을 가진 환경에서 사용됨



### 운영체제의 접근 제어

접근 제어를 수행할 부분 자체를 최소화해야 효율적인 보안 정책을 적용할 수 있다. 운영체제에서 접근 제어는 기본적으로 IP와 포트를 통해 수행되며, 네트워크 인터페이스의 보호와도 밀접하게 관련된다. 관리자는 필요한 서비스만 활성화하고, 불필요한 서비스와 포트는 비활성화해야 한다.



### 응용 프로그램의 접근 제어

클라이언트와 서버 간의 통신에서 SSL 인증서를 사용하여 보안을 강화한다. 이를 통해 데이터를 전송 중에 보호하고, 무단 접근을 방지할 수 있다.





## 권한 관리

### 운영체제의 권한 관리

- 윈도우의 권한 관리
  - `NTFS`: New Technology File System으로, 윈도우의 기본 파일 시스템
  - NFTS에서 그룹 또는 개별 사용자에 대해 설정할 수 있는 권한의 종류는 다음과 같음
    - 모든 권한
    - 수정
    - 읽기 및 실행
    - 디렉토리 내용 보기
    - 읽기
    - 쓰기
  - 위 여섯 가지 권한에는 다음과 같은 규칙이 적용됨
    - 접근 권한이 누락된다
    - 파일 접근이 해당 파일이 위치한 디렉토리 접근 권한보다 우선한다
    - **허용보다 거부가 우선이다**
- 유닉스의 권한 관리
  - 유닉스에서는 다음과 같이 실행 권한을 부여할 수 있음
    - 파일 또는 디렉토리의 소유자
    - 그룹
    - `소유자도 그룹도 아닌 사용자`로 구분하여 읽기, 쓰기, 실행 권한 부여하기



### 데이터베이스의 권한 관리

- 질의문에 대한 권한 관리

  - `DDL`: 데이터 구조를 정의하는 질의문
  - `DML`: 데이터의 검색과 수정 등을 처리
  - `DCL`: 권한 관리를 위한 질의문	
    - `GRANT`: 데이터베이스 객체에 권한을 부여
    - `DENY`: 사용자에게 해당 권한을 금지
    - `REVOKE`: 이미 부여된 데이터베이스 객체의 권한을 취소
  - **`DDL`과 `DML`은 `DCL`에 의해 허용 또는 거부됨**

- 뷰에 대한 권한 관리

  - `뷰에 대한 권한 설정` == `테이블에 대한 권한 설정`

  - 즉, `뷰`와 `테이블`에 대해 권한을 설정하는 방식이 동일하다는 의미

    ```sql
    -- 테이블에 권한 부여
    GRANT SELECT ON employees TO user_name;
    
    -- 뷰에 권한 부여
    GRANT SELECT ON employees_view TO user_name;
    ```



### 응용 프로그램의 권한 관리

보안 관리자 입장에서는 응용 프로그램 내의 권한 관리보다 응용 프로그램 자체의 실행 권한이 더 중요한 경우가 있다. 응용 프로그램은 자신을 실행한 계정의 권한을 물려받기 때문에, 보안상 문제가 있는 취약한 응용 프로그램의 경우 해당 프로그램을 실행한 계정의 권한이 악용되는 문제가 발생한다.

- 공격자가 응용 프로그램의 보안상 취약점을 이용하여 해당 프로세스의 권한을 얻을 수 있음
- 아파치 같은 웹 서버가 `root` 권한으로 실행되는 경우, 공격자가 웹 취약점을 악용하여 `root` 권한을 획득하는 것
  - 윈도우의 `IIS`에서는 실행 프로세스 권한을 별도로 만들어 사용
  - 유닉스에서는 `nobody`와 같이 제한된 계정 권한을 사용



## ✔️ 로그 관리

시스템 사용자가 로그인 후 명령을 내리는 과정에 대한 시스템의 동작을 `AAA`라고 하는데, 이는 `Authentication`, `Authorization`, `Accounting`로 나눌 수 있다. 로그 관리는 이상 징후를 탐지하기 위한 필수적인 작업이다.

- **Authentication(인증)**
  - 자신의 신원을 시스템에 증명하는 과정으로, 시스템은 사용자가 주장하는 신원이 실제로 그 사용자에게 속하는지 확인함
  - 일반적으로 아이디와 비밀번호를 입력하는 과정이 포함됨
  - 2단계 인증(2FA; Two Factor Authentication), 생체 인식, 인증서 기반 인증 등 다양한 방법이 사용될 수 있음
- **Authorization(인가)**
  - 인증된 사용자가 시스템에서 무엇을 할 수 있는지를 결정하는 과정으로, 사용자가 특정 리소스나 기능에 접근할 수 있는지 여부를 판단함
  - 사용자가 인증된 후, 시스템은 해당 자원이나 기능에 접근할 수 있는 권한이 있는지 확인
  - 로그인한 사용자가 특정 프로그램을 실행하거나, 특정 파일에 접근할 수 있는지 확인하고 허락하는 과정
- **Accounting(계정 관리/기록 관리)**
  - 사용자가 시스템에서 수행한 활동을 기록하고, 이를 추적할 수 있도록 하는 과정으로, 시스템 사용 내역을 기록하여 감사 추적과 책임 추적성을 확보함
  - 사용자가 로그인한 시점부터 로그아웃할 때까지의 모든 활동이 기록됨
    - 파일 접근, 명령 실행, 데이터 조회 등이 포함됨
  - 사용자가 특정 파일을 열거나, 데이터를 수정한 기록이 남게 되는데, 이러한 기록은 나중에 보안 분석이나 사고 조사에 활용될 수 있음

이 과정을 통해 시스템의 보안을 강화하고, 책임을 명확히 하며, 감사와 추적을 가능하게 한다.





### 운영체제의 로그 관리

- 윈도우의 로그
  - 윈도우는 `event`라고 불리는 중앙 집중화된 형태로 로그를 수집하여 저장함
  - **중앙 집중화**되어 있기 때문에 로그 관리가 편하지만, 그만큼 **보안 수준이** **높지 않아** 위험도 큼
  - 윈도우의 감사 정책(로깅 정책)은 기본적으로 수행하지 않게 설정되어 있음
- 유닉스의 로그
  - 윈도우와 달리 유닉스 시스템의 로그는 중앙 집중이 아닌, **분산**되어 생성됨
    - `/var/log`에 저장
  - 윈도우보다 상대적으로 공격자를 찾기 쉬움
  - `utmp`: 유닉스 시스템의 가장 기본적인 로그
    - 텍스트가 아닌 바이너리 형태로 로그가 저장됨
    - `w`, `who`, `users`,`whodo`, `finger` 등의 명령어로 로그 확인 가능
    - 주로 계정과 로그인 관련 정보가 기록됨
  - `wtmp`: `utmp` 데몬과 비슷하게 사용자들의 로그인과 로그아웃, 시스템 재부팅에 대한 정보를 담고 있음
    - `last` 명령으로 확인할 수 있음
    - 특정 항목의 내용만 확인하고 싶다면, `last reboot`, `last console`, `last 계정명`과 같이 `last`  명령 뒤에 확인하려는 항목을 추가하면 됨
  - `secure(sulog)`: 페도라, CentOS, 레드햇 등의 리눅스는 `secure` 파일에 원격지 접속 로그와 `su(switch user)`, 사용자 생성 등과 같이 보안에 직접적으로 연관된 로그를 저장함
  - `history`: 명령 창에서 실행한 명령에 대한 기록은 `history`로 확인 가능
  - `syslog`: 시스템 운영과 관련한 전반적인 로그
    - `/var/log/messages` 파일에 하드웨어의 구동, 서비스의 동작, 에러 등의 다양한 로그를 남김



### 데이터베이스의 로그 관리

- 데이터베이스 모니터링
  - 데이터베이스에 대한 로그를 남기는 가장 좋은 방법은 별도의 데이터베이스 모니터링 툴을 도입하는 것
  - ex. 네트워크 트래픽을 모니터링할 수 있는 태핑 장비를 네트워크에 설치하고, 네트워크 패킷 중에서 데이터베이스 질의문을 확인하여 이를 로그로 남김
  - 이러한 방식은 데이터베이스의 성능에 영향을 미치지 않으면서 잘못된 접근 시도와 질의문 입력을 모두 모니터링 가능



### 네트워크 장비의 로그 관리

일반적으로 네트워크의 경우, 대량의 트래픽이 생성되고 대부분의 트래픽이 일시적으로 존재했다가 사라지기 때문에 살펴볼 수 있는 로그가 그리 다양하지 않다.

네트워크와 관련한 다양한 시스템을 구비해놓을 경우 살펴볼 수 있는 로그는 크게 세 가지이다.

- 네트워크 **보안** 시스템의 로그: 다양한 보안 시스템의 로그는 통합 로그 관리 시스템에 의해 수집, 관리되기도 함
- 네트워크 **관리** 시스템의 로그
  - 네트워크 트래픽 모니터링 시스템
  - 네트워크 관리 시스템
- 네트워크 장비 인증 시스템의 로그
  - 라우터나 스위치 같은 네트워크 장비에는 로그를 남기는 기능이 있지만, 대부분의 네트워크 장비 자체에는 하드디스크와 같은 저장 공간이 없어 로그를 남기지 않은 채로 운영됨
    - 대신 로그 서버를 별도로 두고 운영함
  - 공격자가 로그를 삭제하려면 로그 서버에 대한 해킹도 성공해야 함
  - 해커가 어떤 네트워크 장비에 침투하더라도 자신의 흔적을 지우기는 쉽지 않음





## ✔️ 취약점 관리

### 패치 관리

보안 설정을 아무리 잘해도 시스템 자체에 취약점이 존재하면 시스템 운영자 수준에서 이를 막을 수 있는 방법이 없다.

이럴 때는 운영체제나 데이터베이스와 같은 응용 프로그램을 만든 제작사가 배포하는 패치 또는 서비스 팩을 적용해야 한다.



### 응용 프로그램별 고유 위험 관리

응용 프로그램 중에는 해당 응용 프로그램을 통해 운영체제의 파일이나 명령을 실행할 수 있는 것이 있다.



### 응용 프로그램의 정보 수집 제한

응용 프로그램이 운영체제에 직접적인 영향을 미치지 않더라도 응용 프로그램의 특정 기능이 운영체제의 정보를 노출시키기도 한다.

- 일반 사용자는 `텔넷`을 이용하여 시스템에 존재하는 계정 목록을 어느 정도 파악
  - 이러한 응용 프로그램의 기능은 제한하는 것이 바람직함












# Reference

https://velog.io/@woobuntu/%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%B3%B4%EC%95%88

https://velog.io/@beneficial/Session%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80

https://velog.io/@elena/%EB%B3%B4%EC%95%88%EC%9D%98-3%EB%8C%80-%EC%9A%94%EC%86%8C-CIA-Triad