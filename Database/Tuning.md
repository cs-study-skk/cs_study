# π‘‰SQL νλ‹μ΄λ€
**κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μµμ†ν•μ μμ›μ„ μ‚¬μ©ν•΄ μ„λ²„μ μ²λ¦¬μ†λ„λ¥Ό λ†’μ΄λ” κ²ƒ** <br/>
> **SQL νλ‹μ΄ ν•„μ”ν• μ΄μ ?**
> <br/>μΏΌλ¦¬ νλ‹μ€ μ‹μ¤ν… μ„±λ¥μ— μ§μ ‘μ μΈ μν–¥μ„ λ―ΈμΉλ‹¤.
> <br/>μµμ ν™”λμ§€ μ•μ€ μΏΌλ¦¬λ” μ‘λ‹µ μ†λ„ μ €ν•, μμ›λ‚­λΉ„, μ‹¬μ§€μ–΄λ” μ„λΉ„μ¤ μ¥μ• κΉμ§€ μ΄λν•  μ μλ‹¤.

## μΈλ±μ¤ ν™μ©
μΈλ±μ¤λ¥Ό μ‚¬μ©ν•λ©΄ λ°μ΄ν„°λ² μ΄μ¤κ°€ νΉμ • μ—΄μ„ μ‰½κ² μ°Ύμ„ μ μλ‹¤.

### μ μ ν• μΈλ±μ¤ μƒμ„±
μΈλ±μ¤λ΅ μƒμ„±ν•κΈ° μΆ‹μ€ μ»¬λΌμ€ μ•„λμ™€ κ°™λ‹¤.
- κ³ μ ν• κ°’ νΉμ€ μμ£Ό μ΅°νλλ” μ»¬λΌ
- μ΅°κ±΄μ (WHERE, JOIN, ORDER BY, GROUP BY λ“±)μ— μ‚¬μ©λλ” μ»¬λΌ
- μμ£Ό μ—…λ°μ΄νΈ λμ§€ μ•λ” μ»¬λΌ 
- null κ°’μ΄ μ μ€ μ»¬λΌ
  
**μ) μΈλ±μ¤ μƒμ„±**

```sql
SELECT *
FROM orders
WHERE order_date > '2021-01-01'
ORDER BY order_id
```
μ΄ μΏΌλ¦¬μ—μ„λ” WHERE μ μ—μ„ order_date μ—΄μ— λ€ν• μ΅°κ±΄μ„ μ‚¬μ©ν•κ³ , ORDER BY μ μ—μ„ order_id μ—΄μ„ μ‚¬μ©ν•λ‹¤. 
<br/>λ”°λΌμ„, order_dateμ™€ order_id μ—΄μ— λ€ν• μΈλ±μ¤λ¥Ό λ§λ“¤μ–΄ μΏΌλ¦¬μ μ‹¤ν–‰ μ†λ„λ¥Ό ν–¥μƒμ‹ν‚¬ μ μλ‹¤.


### μΈλ±μ¤μ»¬λΌμ€ λ³€ν•ν•μ—¬ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤.
**μ) νΉμ • λ…„λ„μ λ°μ΄ν„°λ§ ν•„ν„°λ§**
- before
```sql
SELECT *
FROM sales
WHERE YEAR(date) = 2021;
```
- after
```sql
SELECT *
FROM sales 
WHERE date >= '2021-01-01' AND date <= '2021-12-31';
```
λ°μ΄ν„° μ›λ³Έμ„ λ³€ν•ν•μ—¬, λ‚΄κ°€ μ°Ύκ³ μ ν•λ” λ²”μ„μ™€ λΉ„κµν•λ” μ—°μ‚°μ€ λ°μ΄ν„°λ² μ΄μ¤κ°€ μΈλ±μ¤λ¥Ό μ λ€λ΅ ν™μ©ν•  μ μ—†κ² λλ‹¤. 
<br/>λ•λ¬Έμ— λ‹¤μκ³Ό κ°™μ΄ μΏΌλ¦¬λ¥Ό λ°”κΏ” **λ°μ΄ν„°λ¥Ό 'λ³€ν•'ν•μ§€ μ•κ³ , μ›λ³Έ ν•νƒλ¥Ό μ μ§€**ν•λ©΄μ„ ν•„μ”ν• λ°μ΄ν„°λ¥Ό μ°Ύλ”λ‹¤.

## μ„λΈμΏΌλ¦¬ μµμ†ν™”
μ„λΈμΏΌλ¦¬λ” λ³µμ΅ν• μΏΌλ¦¬λ¥Ό μ‘μ„±ν•  λ• μ μ©ν•μ§€λ§, μ„±λ¥ μ €ν•μ μ›μΈμ΄ λ  μ μμ–΄ μ‚¬μ©μ„ μµμ†ν™”ν•λ” κ²ƒμ΄ μΆ‹λ‹¤. 
<br/>μ„λΈμΏΌλ¦¬ λ€μ‹  JOIN, UNION, EXISTS λ“±μ λ‹¤λ¥Έ λ°©λ²•μ„ μ‚¬μ©ν•μ—¬ μΏΌλ¦¬λ¥Ό μ‘μ„±ν•λ” κ²ƒμ΄ μΆ‹λ‹¤. 
<br/><br/>
**μ) μ„±λ³„μ΄ μ—¬μ„±μΈ κ³ κ°μ΄ μ£Όλ¬Έν• λ¨λ“  μ£Όλ¬Έμ„ κ°€μ Έμ΄**
- before
```sql
SELECT *
FROM orders
WHERE customer_id IN (
  SELECT customer_id
  FROM customers
  WHERE gender = 'F'
)
```
- after
```sql
SELECT orders.*
FROM orders
JOIN customers
ON orders.customer_id = customers.customer_id
WHERE customers.gender = 'F'
```
JOINμ„ μ‚¬μ©ν•μ—¬ κ°™μ€ κ²°κ³Όλ¥Ό μ–»μ„ μ μμΌλ―€λ΅ μ„λΈμΏΌλ¦¬λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ λ¶€μ μ ν•λ‹¤.

## μ μ λμ—μ„λ§ μ™€μΌνΈ μΉ΄λ“λ¥Ό μ‚¬μ©
μ™€μΌλ“μΉ΄λ“λ” λ¬Έμν™” λ κ°’λ“¤μ„ μ°Ύμ„ λ• μ•„μ£Ό κ΄‘λ²”μ„ν•κ² μ°Ύκ² λΌ ν¨μ¨μ„±μ΄ λ§¤μ° λ–¨μ–΄μ§„λ‹¤. 
<br/>μ™€μΌλ“μΉ΄λ“λ¥Ό μ‚¬μ©ν•κ² λλ©΄, λ°μ΄ν„°λ² μ΄μ¤λ” μ΅°κ±΄μ„ λ§μ΅±ν•λ” κ°’μ„ μ°ΎκΈ° μ„ν•΄ λ¨λ“  λ μ½”λ“λ¥Ό λ’¤μ Έμ•Ό ν•λ‹¤.
<br/><br/>
**μ) μ΄λ¦„μ΄ John~μΈ μ‚¬μ©μλ¥Ό μ΅°ν**
- before
```sql
SELECT * FROM users WHERE name LIKE '%John';
```
- after
```sql
SELECT * FROM users WHERE name LIKE 'John%';
```
λ‹¤μκ³Ό κ°™μ΄ μΏΌλ¦¬λ¥Ό λ³€κ²½ν•λ©΄ λ°μ΄ν„°λ² μ΄μ¤κ°€ μΈλ±μ¤λ¥Ό ν™μ©ν•΄μ„ κ²€μƒ‰ λ²”μ„λ¥Ό ν¨κ³Όμ μΌλ΅ μΆν μ μλ‹¤.
<br/>λ°μ΄ν„°λ² μ΄μ¤λ” μ°μ„  μΈλ±μ¤μ—μ„ 'John'μΌλ΅ μ‹μ‘ν•λ” μ²« λ²μ§Έ ν•­λ©μ„ λΉ λ¥΄κ² μ°Ύμ•„λ‚΄κ³  'John'μΌλ΅ μ‹μ‘ν•μ§€ μ•λ” μ²« λ²μ§Έ ν•­λ©μ΄ λ‚μ¬ λ•κΉμ§€λ§ κ²€μƒ‰ν•λ‹¤.

## μΏΌλ¦¬ μ‹¤ν–‰ κ³„ν ν™•μΈ 
μΏΌλ¦¬ μ‹¤ν–‰ κ³„νμ€ λ°μ΄ν„°λ² μ΄μ¤κ°€ **μΏΌλ¦¬λ¥Ό μ‹¤ν–‰ν•  λ• μ–΄λ–¤ λ°©μ‹μΌλ΅ λ°μ΄ν„°λ¥Ό κ²€μƒ‰ν•λ”μ§€** μ•λ ¤μ¤€λ‹¤. 
<br/>λ”°λΌμ„ μΏΌλ¦¬ μ‹¤ν–‰ κ³„νμ„ ν™•μΈν•μ—¬ μΏΌλ¦¬μ μ„±λ¥μ„ λ¶„μ„ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤. 
Β 
<br/>λ€λ¶€λ¶„μ λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ¦¬ μ‹μ¤ν…μ—μ„ μΏΌλ¦¬ μ‹¤ν–‰ κ³„νμ„ ν™•μΈν•  μ μμΌλ©°, κ° λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ¦¬ μ‹μ¤ν…λ§λ‹¤ ν™•μΈν•λ” λ°©λ²•μ΄ λ‹¤λ¥΄λ‹¤. 
<br/><br/>
**μ) MySQLμ—μ„μ μ‹¤ν–‰ κ³„ν μ΅°ν**
- query
```sql
EXPLAIN SELECT *
FROM orders
WHERE order_date > '2021-01-01'
ORDER BY order_id
```
- μ‹¤ν–‰ κ³„ν
```
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+--------------------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra                    |
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+--------------------------+
|  1 | SIMPLE      | orders| NULL       | ALL  | NULL          | NULL | NULL    | NULL | 1000 |    11.11 | Using where; Using filesort|
+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+--------------------------+
```
μ΄ μΏΌλ¦¬ μ‹¤ν–‰ κ³„νμ—μ„λ” orders ν…μ΄λΈ”μ„ μ „μ²΄ μ¤μΊ”ν•κ³ , WHERE μ μ—μ„ order_date μ—΄μ„ μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ¥Ό ν•„ν„°λ§ν•λ‹¤. 
<br/>ν•μ§€λ§, μΈλ±μ¤λ¥Ό μ‚¬μ©ν•μ§€ μ•μ•„ μ„±λ¥μ΄ μ €ν•λ  μ μλ‹¤.
<br/>μ΄μ™€ κ°™μ΄ μΏΌλ¦¬ μ‹¤ν–‰ κ³„νμ„ ν™•μΈν•μ—¬ μ„±λ¥ μ €ν•μ μ›μΈμ„ νμ•…ν•κ³ , μΈλ±μ¤λ‚ JOIN μ΅°κ±΄ λ“±μ„ μμ •ν•μ—¬ μ„±λ¥μ„ κ°μ„ ν•  μ μλ‹¤.




## Reference
https://chung-develop.tistory.com/145
https://velog.io/@hyunspace/about-sql-tuning
