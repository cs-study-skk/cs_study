# ✔️ 정규화

정규화란 하나의 종속성이 하나의 릴레이션으로 표현되도록 분해하는 과정이다. 즉, 하나의 릴레이션에 하나의 의미만 존재하도록 릴레이션을 분해하는 과정이다.

데이터의 중복성을 최소화하여 중복에 따른 변경 이상(Anomaly) 현상을 제거하는 과정인데, 이를 통해 데이터 구조의 안정성을 최대화한다. 떄문에 테이블의 구성을 논리적이고 직관적으로 한다.

결론적으로 정규화는 **데이터의 일관성, 최소한의 데이터 중복, 최대한의 데이터 유연성**을 위한 방법이다.

**논리 설계 단계에서 수행**하며, 물리적 구조에 영향을 주지는 않는다.



>  **📌 정리! 정규화의 목적**
>
> - 중복 데이터를 최소화하여 테이블 불일치 위험을 최소화하기
> - 수정, 삭제 시 이상 현상을 방지함으로써 데이터 구조의 일관성 최대화
> - 데이터 삽입 시 릴레이션의 재구성에 대한 필요성을 줄이기
> - 효과적인 검색 알고리즘 생성 가능



## 📎 정규화의 단계

정규화는 1부터 6 정규화(1, 2, 3, bcnf, 4, 5)까지의 여러 과정이 존재하는데, 실제로는 보통 1부터 3 정규화까지의 과정을 거치게 된다.



![image (3)](/Users/isoyeon/Desktop/image (3).png)





### **1. 제1정규형(First Normal Form, 1NF)**

- 어떤 릴레이션 R에 속한 모든 도메인이 **원자값(Atomic Value)**만으로 되어 있음

  > **원자값**이란, 하나의 애트리뷰트가 하나의 값만 가지는 것을 의미함

- 1NF는 다음을 만족함

  - 각 컬럼이 하나의 속성만을 가져야 함

  - 하나의 컬럼은 같은 종류나 타입(type)의 값을 가져야 함

  - 각 컬럼이 유일한(unique) 이름을 가져야 함

  - 컬럼의 순서가 상관없어야 함

- 데이터 간 중복성이 강함 

- 예시

  | 학생ID | 이름   | 수강과목               |
  | ------ | ------ | ---------------------- |
  | 1      | 김철수 | 데이터베이스, 정보보호 |
  | 2      | 홍길동 | 한국사, 토익 스피킹    |

- 위 테이블을 1NF로 변환하면 다음과 같음

  | 학생ID | 이름   | 수강과목     |
  | ------ | ------ | ------------ |
  | 1      | 김철수 | 데이터베이스 |
  | 1      | 김철수 | 정보보호     |
  | 2      | 홍길동 | 한국사       |
  | 2      | 홍길동 | 토익 스피킹  |



### 2. 제2정규형 (Second Normal Form, 2NF)



- 2NF는 다음을 만족함

  - 제 1정규형을 만족함.

  - 모든 컬럼이 부분적 종속이 없어야 함. 즉, 모든 컬럼이 완전 함수 종속을 만족함.

    > **📌 부분 함수 종속 (Partial Functional Dependency)**
    >
    > : 기본키 중에 특정 컬럼에만 종속되는 것
    >
    > 
    >
    >
    > 📌 **완전 함수 종속 (Full Functional Dependency)**
    >
    > : 기본키의 부분집합이 결정자가 되어선 안 됨

- 제1정규화를 진행한 테이블에 대해 완전 함수 종속을 만족하도록 테이블을 분해하는 과정

- 예시

  | <u>학생ID</u> | <u>과목코드</u> | 과목명       |
  | ------------- | --------------- | ------------ |
  | 1             | AC1             | 데이터베이스 |
  | 1             | AC2             | 정보보호     |
  | 2             | CC1             | 한국사       |
  | 2             | CC2             | 토익 스피킹  |

- 이 테이블은 `학생ID`와 `과목코드`가 기본키(복합키)라고 가정한다. 이 테이블은 제1정규형은 만족하지만, 부분 함수 종속성이 존재한다.

  - 위 예시 테이블은 모든 열이 원자값을 가지므로 제 1정규형을 만족한다.
  - `과목명`은 `과목코드`에만 종속되며, `학생 ID`에는 종속되지 않는다. 따라서 부분 함수 종속성을 제거하기 위해 테이블을 분리해야 한다.

- 위 테이블을 2NF로 변환하면, `학생` 테이블과 `과목` 테이블로 분리하게 됨

  - 학생 테이블:

  | 학생ID | 이름 |
  | ------ | ---- |
  | 1      | AC1  |
  | 1      | AC2  |
  | 2      | CC1  |
  | 2      | CC2  |

  - 과목 테이블:

  | 과목코드 | 과목명       |
  | -------- | ------------ |
  | AC1      | 데이터베이스 |
  | AC2      | 정보보호     |
  | CC1      | 한국사       |
  | CC2      | 토익 스피킹  |






### **3. 제3정규화(Third Normal Form, 3NF)**

- 제 2정규형을 만족하면서, 기본키가 아닌 열 간의 종속성을 제거하며 테이블을 재구성하는 과정

- 즉, 제2정규화를 진행한 테이블에 대해 **이행적 함수 종속**을 없애도록 테이블을 분해하는 과정

  > **📌 이행적 함수 종속 (Transitive Functional Dependency) **
  >
  > :  `A → B`,` B → C`가 성립할 때 `A → C`가 성립되는 것

- 예시

  | <u>학생ID</u> | <u>과목코드</u> | 과목명       | 교수명 |
  | ------------- | --------------- | ------------ | ------ |
  | 1             | AC1             | 데이터베이스 | 이교수 |
  | 1             | AC2             | 정보보호     | 박교수 |
  | 2             | CC1             | 한국사       | 최교수 |
  | 2             | CC2             | 토익 스피킹  | 김교수 |

- 이 예시 테이블은 `과목코드 → 과목명`, `과목코드 → 교수명`이 성립하므로, 이행적 함수 종속성을 제거해야 함

- 과목과 교수 정보를 분리

  - 학생 테이블:

  | 학생ID | 이름   |
  | ------ | ------ |
  | 1      | 김철수 |
  | 2      | 홍길동 |

  - 과목 테이블:

  | 과목코드 | 과목명       |
  | -------- | ------------ |
  | AC1      | 데이터베이스 |
  | AC2      | 정보보호     |
  | CC1      | 한국사       |
  | CC2      | 토익 스피킹  |

  - 수강 테이블:

  | 학생ID | 과목코드 |
  | ------ | -------- |
  | 1      | AC1      |
  | 1      | AC2      |
  | 2      | CC1      |
  | 2      | CC2      |

  - 교수 테이블:

  | 과목코드 | 교수명 |
  | -------- | ------ |
  | AC1      | 이교수 |
  | AC2      | 박교수 |
  | CC1      | 최교수 |
  | CC2      | 김교수 |



### 4. **BCNF(Boyce-Codd Normal Form)** 

- BCNF가 3NF보다 더 제한이 엄격함
- 모든 결정자가 후보키가 되도록 함
- 제3정규형에서 후보키가 아닌 결정자가 존재할 때 BCNF가 필요함
- 예시

| <u>학생번호</u> | <u>과목</u> | 지도교수 |
| --------------- | ----------- | -------- |
| 101             | 자바        | 김자바   |
| 101             | C++         | 박플플   |
| 102             | 자바        | 오자바   |
| 103             | C#          | 조씨샵   |
| 104             | 자바        | 김자바   |

- 기본 키는 (학생번호, 과목)이고, `지도교수 → 과목`이라는 종속성이 있다. 이는 지도교수를 알면 과목을 알 수 있음을 의미한다.
- BCNF는 모든 결정자가 `후보 키`가 되어야 하는 정규화 조건인데, `지도교수`는 **후보 키가 아니지만 과목을 결정**함
- 때문에 `학생 - 지도교수` 테이블과 `지도교수 - 과목` 테이블로 분리
  - 학생 - 지도교수 테이블


| 학생번호 | 지도교수 |
| -------- | -------- |
| 101      | 김자바   |
| 101      | 박플플   |
| 102      | 오자바   |
| 103      | 조씨샵   |
| 104      | 김자바   |

- 지도교수-과목 테이블

| 지도교수 | 과목 |
| -------- | ---- |
| 김자바   | 자바 |
| 박플플   | C++  |
| 오자바   | 자바 |
| 조씨샵   | C#   |





### 5. **제4정규형 (Fourth Normal Form, 4NF)**

- 다치 종속성(MVD; Multi-Valued Dependency)을 제거하여 데이터베이스 설계

  > **📌 다치 종속 (Multi-valued Dependency)**
  >
  > : 같은 테이블 내의 독립적인 두 개 이상의 컬럼이 또 다른 컬럼에 종속되는 것을 말한다.
  > 즉, A → B 인 의존성에서 단일 값 A와 다중 값 B가 존재한다면 다치 종속이라고 할 수 있다. 이러한 종속을 A ↠ B 로 표기한다. (다치 종속은 이중 화살표(double arrow) ↠ 로 표기한다.)
  >
  > 다치 종속은 최소 2개의 컬럼이 다른 컬럼에 종속되어야 하기 때문에 최소 3개의 컬럼이 필요하다.

- 하나의 속성이 다른 여러 속성에 독립적으로 종속될 때 발생하는 문제 해결

- 예시

| 개발자 | 자격증            | 언어 |
| ------ | ----------------- | ---- |
| 홍길동 | 정보처리기사      | C    |
| 홍길동 | 빅데이터 분석기사 | C++  |
| 장길산 | 정보보안기사      | JAVA |

- 이 테이블은 `개발자 → 자격증`, `개발자 → 언어` 두 가지 의존성을 가지므로 다치 종속이 존재함

  - 개발자 - 자격증 테이블

    | 개발자 | 자격증            |
    | ------ | ----------------- |
    | 홍길동 | 정보처리기사      |
    | 홍길동 | 빅데이터 분석기사 |
    | 장길산 | 정보보안기사      |

  - 개발자 - 언어 테이블

    | 개발자 | 언어 |
    | ------ | ---- |
    | 홍길동 | C    |
    | 홍길동 | C++  |
    | 장길산 | JAVA |

    



### 6. **제5정규형(Fifth Normal Form, 5NF)**

- 조인 종속을 제거하는 과정

  > **📌 조인 종속 (Joint Dependency) **
  >
  > : 하나의 릴레이션을 여러개의 릴레이션으로 분해하였다가, 다시 조인했을 때 데이터 손실이 없고 필요없는 데이터가 생기는 것을 말한다. 조인 종속성은 다치 종속의 개념을 더 일반화한 것이다.

- 릴레이션 R에 존재하는 모든 종속이 릴레이션 R의 후보키를 통해서만 성립될 때 진행

- PJ/NF(Projection-Join Normal Form)이라고도 함

- **즉, 5NF는 4NF 테이블을 다시 조인해서 원래 테이블을 구성할 수 있음을 보장하는 정규형**





# +) ✔️ 역정규화(Denormalization; 반정규화)

- 정규화를 거듭할수록 검색 질의의 수행 속도는 떨어질 때 검색 질의 수행 속도 향상이 목적
  - 데이터 조회 시 디스크 I/O가 많아서 성능 저하 발생
  - 경로가 너무 멀어 조인으로 인한 성능 저하
  - 과도한 정규화로 인한 데이터 분산화
  - 정상적인 정규화를 통한 고객의 품질 요구사항 충족이 어려운 경우(Full Search)
- 이미 분해된 두 개 이상의 릴레이션들을 합쳐서 하나의 릴레이션으로 만드는 작업
- 정규화가 분해의 작업이라면 역정규화는 정규화를 거꾸로 하여 병합하는 작업











### 참고

https://dev-coco.tistory.com/62

https://velog.io/@wisdom-one/%EC%A0%95%EA%B7%9C%ED%99%94Normalization#4-%EB%B3%B4%EC%9D%B4%EC%8A%A4-%EC%BD%94%EB%93%9C-%EC%A0%95%EA%B7%9C%ED%99%94-bcnf
